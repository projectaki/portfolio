<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Portfolio</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Akos Madarasz's portfolio website" />
    <meta name="keywords" content="akos, madarasz, akos madarasz, portfolio" />
    <meta name="author" content="Akos Madarasz" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  </head>
  <body class="mat-typography">
    <app-root></app-root>
  </body>
  <script>
    const sidenav = document.querySelector('#sidenav-mobile');
    const sidenavToggle = document.querySelector('#sidenav-toggle');
    const themeToggle = document.getElementById('toggle');
    const links = document.querySelectorAll('.nav-link');

    if (links.length > 0) {
      links.forEach(link => {
        link.addEventListener('click', closeMenu);
      });
    }

    if (sidenav && sidenavToggle) {
      sidenavToggle.addEventListener('click', toggle);
    }

    if (themeToggle) {
      themeToggle.addEventListener('click', toggleTheme);
    }

    function toggle() {
      sidenav?.classList.toggle('hidden');
    }

    function toggleTheme() {
      document.body.classList.toggle('lightMode');
    }

    function closeMenu() {
      const contains = sidenav.classList.contains('hidden');
      if (!contains) sidenav.classList.add('hidden');
    }
  </script>
  <script>
    const tocContainer = document.querySelector('#toc-container');
    const pageContent = document.querySelector('app-toc .page-content');

    function getRandom() {
      const array = new Uint32Array(1);
      return window.crypto.getRandomValues(array)[0];
    }

    function createEl({ id, title }) {
      const div = document.createElement('div');

      div.onclick = () => document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'start' });
      div.innerText = title;
      div.classList.add('nav-link');
      div.classList.add('nav-link:hover');
      return div;
    }

    function recurse({ elem, parent }) {
      const search = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6'];

      for (const child of elem.children) {
        if (search.some(x => x === child.tagName)) {
          child.id = getRandom();
          const el = createEl({ id: child.id, title: child.innerText });

          parent.appendChild(el);
        }
        recurse({ elem: child, parent });
      }
    }

    recurse({
      elem: document.querySelector('app-toc .page-content'),
      parent: document.querySelector('#toc-container'),
    });
  </script>
</html>
